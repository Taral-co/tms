<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Chat Widget Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
        }
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .demo-controls {
            margin-bottom: 24px;
            padding: 16px;
            background: #f1f5f9;
            border-radius: 6px;
        }
        .control-group {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-bottom: 12px;
        }
        button {
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }
        button:hover {
            background: #f3f4f6;
        }
        button.primary {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        select, input {
            padding: 6px 10px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
        }
        .theme-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }
        .theme-card {
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        .theme-card:hover {
            border-color: #3b82f6;
        }
        .theme-card.active {
            border-color: #3b82f6;
            background: #eff6ff;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <h1>Enhanced Chat Widget Demo</h1>
        <p>This page demonstrates the enhanced chat widget with multiple themes, session persistence, and enterprise features.</p>
        
        <div class="demo-controls">
            <h3>Widget Controls</h3>
            
            <div class="control-group">
                <button id="openWidget" class="primary">Open Widget</button>
                <button id="closeWidget">Close Widget</button>
                <button id="toggleWidget">Toggle Widget</button>
                <button id="sendTestMessage">Send Test Message</button>
            </div>
            
            <div class="control-group">
                <label>Theme:</label>
                <select id="themeSelect">
                    <option value="rounded">Rounded (Friendly)</option>
                    <option value="square">Square (Professional)</option>
                    <option value="minimal">Minimal (Clean)</option>
                    <option value="professional">Professional (Enterprise)</option>
                    <option value="modern">Modern (Contemporary)</option>
                    <option value="classic">Classic (Traditional)</option>
                </select>
                
                <label>Size:</label>
                <select id="sizeSelect">
                    <option value="small">Small</option>
                    <option value="medium" selected>Medium</option>
                    <option value="large">Large</option>
                </select>
                
                <label>Position:</label>
                <select id="positionSelect">
                    <option value="bottom-right" selected>Bottom Right</option>
                    <option value="bottom-left">Bottom Left</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>Agent Name:</label>
                <input type="text" id="agentName" value="Sarah Johnson" placeholder="Agent name">
                
                <label>Primary Color:</label>
                <input type="color" id="primaryColor" value="#3b82f6">
                
                <button id="updateConfig">Update Configuration</button>
            </div>
            
            <div class="control-group">
                <button id="getSessionInfo">Get Session Info</button>
                <button id="clearSession">Clear Session</button>
                <button id="exportStorage">Export Storage Data</button>
            </div>
        </div>
        
        <div class="theme-preview">
            <div class="theme-card" data-theme="rounded">
                <div style="font-size: 24px;">üîµ</div>
                <strong>Rounded</strong>
                <div>Friendly & modern</div>
            </div>
            <div class="theme-card" data-theme="square">
                <div style="font-size: 24px;">‚¨õ</div>
                <strong>Square</strong>
                <div>Professional & clean</div>
            </div>
            <div class="theme-card" data-theme="minimal">
                <div style="font-size: 24px;">‚ö™</div>
                <strong>Minimal</strong>
                <div>Simple & clean</div>
            </div>
            <div class="theme-card" data-theme="professional">
                <div style="font-size: 24px;">üè¢</div>
                <strong>Professional</strong>
                <div>Enterprise & formal</div>
            </div>
            <div class="theme-card" data-theme="modern">
                <div style="font-size: 24px;">‚ú®</div>
                <strong>Modern</strong>
                <div>Contemporary & sleek</div>
            </div>
            <div class="theme-card" data-theme="classic">
                <div style="font-size: 24px;">üìù</div>
                <strong>Classic</strong>
                <div>Traditional & reliable</div>
            </div>
        </div>
        
        <h3>Features Demonstrated</h3>
        <ul>
            <li><strong>6 Widget Themes</strong>: Each with unique visual styling</li>
            <li><strong>Session Persistence</strong>: Reload page to see session restored</li>
            <li><strong>Agent Personalization</strong>: Custom names and avatars</li>
            <li><strong>Real-time Configuration</strong>: Update widget appearance live</li>
            <li><strong>Accessibility</strong>: WCAG AA compliant with keyboard navigation</li>
            <li><strong>Enterprise Features</strong>: Business hours, notifications, file uploads</li>
        </ul>
        
        <h3>Test Instructions</h3>
        <ol>
            <li>Open the widget and start a conversation</li>
            <li>Try different themes and see the visual changes</li>
            <li>Reload the page - your session should persist</li>
            <li>Test keyboard navigation (Tab, Enter, Escape)</li>
            <li>Check the session info to see storage details</li>
        </ol>
    </div>

    <!-- Chat Widget Integration -->
    <script src="./dist/chat-widget.js"></script>
    <script>
        // Initialize the enhanced chat widget
        const widget = new TMSChatWidget({
            domain: 'localhost',
            widgetId: 'demo-widget-123',
            apiUrl: 'http://localhost:8080',
            enableSessionPersistence: true,
            debugMode: true
        });

        // Demo controls
        document.getElementById('openWidget').addEventListener('click', () => {
            widget.openWidget();
        });

        document.getElementById('closeWidget').addEventListener('click', () => {
            widget.closeWidget();
        });

        document.getElementById('toggleWidget').addEventListener('click', () => {
            widget.toggleWidget();
        });

        document.getElementById('sendTestMessage').addEventListener('click', () => {
            widget.sendExternalMessage('Hello! This is a test message from the demo controls.');
        });

        document.getElementById('updateConfig').addEventListener('click', () => {
            const theme = document.getElementById('themeSelect').value;
            const size = document.getElementById('sizeSelect').value;
            const position = document.getElementById('positionSelect').value;
            const agentName = document.getElementById('agentName').value;
            const primaryColor = document.getElementById('primaryColor').value;

            widget.updateWidgetConfig({
                widget_shape: theme,
                widget_size: size,
                position: position,
                agent_name: agentName,
                primary_color: primaryColor
            });

            // Update theme preview
            document.querySelectorAll('.theme-card').forEach(card => {
                card.classList.toggle('active', card.dataset.theme === theme);
            });
        });

        document.getElementById('getSessionInfo').addEventListener('click', () => {
            const info = widget.getSessionInfo();
            alert(JSON.stringify(info, null, 2));
        });

        document.getElementById('clearSession').addEventListener('click', () => {
            if (confirm('Clear stored session data?')) {
                // This would need to be implemented in the widget
                localStorage.clear();
                location.reload();
            }
        });

        document.getElementById('exportStorage').addEventListener('click', () => {
            const data = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('tms_')) {
                    data[key] = localStorage.getItem(key);
                }
            }
            console.log('Storage Data:', data);
            alert('Storage data exported to console');
        });

        // Theme preview selection
        document.querySelectorAll('.theme-card').forEach(card => {
            card.addEventListener('click', () => {
                const theme = card.dataset.theme;
                document.getElementById('themeSelect').value = theme;
                document.getElementById('updateConfig').click();
            });
        });

        // Widget event listeners for demo
        widget.on('session:started', (session) => {
            console.log('Session started:', session);
        });

        widget.on('message:received', (message) => {
            console.log('Message received:', message);
        });

        widget.on('message:sent', (message) => {
            console.log('Message sent:', message);
        });

        widget.on('error', (error) => {
            console.error('Widget error:', error);
        });

        // Initialize with rounded theme
        setTimeout(() => {
            document.querySelector('[data-theme="rounded"]').classList.add('active');
        }, 100);
    </script>
</body>
</html>
